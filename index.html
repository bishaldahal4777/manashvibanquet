<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dynamic Checkbox Form with Verify</title>
    <style>
      .gallery-header {
        text-align: center;
        margin-bottom: 20px;
      }
      .main-box {
        border: 1px solid #ccc;
        padding: 20px;
        margin: 20px 0;
      }
      .category-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }
      .category-box {
        width: calc(20% - 10px);
        border: 1px solid #ddd;
        padding: 10px;
        border-radius: 5px;
        text-align: center;
      }
      .category-box h3 {
        font-size: 1.2em;
        margin-bottom: 10px;
      }
      .selected-options {
        margin-top: 20px;
        font-family: Arial, sans-serif;
        background: #f9f9f9;
        border: 1px solid #ccc;
        padding: 10px;
        border-radius: 5px;
      }
      .input-section {
        margin-top: 20px;
      }
      input[type="text"],
      input[type="email"] {
        padding: 8px;
        margin: 5px 0;
        width: 200px;
      }
      button {
        padding: 10px 20px;
        margin-top: 10px;
      }
      .error {
        color: red;
        font-size: 0.9em;
      }
    </style>
  </head>
  <body>
    <div class="gallery-header">
      <h1>Customized Menu Pack</h1>
      <form id="dynamicForm">
        <div class="main-box">
          <h2>Package Includes</h2>
          <div class="category-container">
            <!-- Function to Create Each Category -->
            <script>
              function createCategory(
                title,
                name,
                type,
                options,
                maxSelections = 1
              ) {
                let html = `<div class='category-box'><h3>${title} (${maxSelections} item${
                  maxSelections > 1 ? "s" : ""
                })</h3><ul>`;
                options.forEach((option) => {
                  const inputType = type === "radio" ? "radio" : "checkbox";
                  const arrayName = type === "checkbox" ? "[]" : "";
                  html += `<li><input type='${inputType}' name='${name}${arrayName}' value='${option}' onclick="validateSelection('${name}', ${maxSelections})" />${option}</li>`;
                });
                html += "</ul></div>";
                return html;
              }
            </script>

            <!-- Categories -->
            <script>
              document.write(
                createCategory("Roti", "roti", "checkbox", [
                  "Butter Naan",
                  "Plain Roti",
                  "Butter Roti",
                  "Tandoori Naan",
                  "Tava Roti",
                  "Bhatura",
                ])
              );
              document.write(
                createCategory("Rice", "rice", "checkbox", [
                  "Plain Pulao",
                  "Nuts Pulao",
                  "Jeera Rice",
                  "Kashmiri Pulao",
                  "Plain Rice",
                  "Veg Pulao",
                  "Veg Biryani",
                ])
              );
              document.write(
                createCategory("Daal", "daal", "checkbox", [
                  "Yellow Dal",
                  "Daal Makhani",
                  "Rajma Daal",
                  "Kalo Daal",
                  "Daal Tadka",
                  "Dal Fry",
                  "Maas Ko Dal",
                ])
              );
              document.write(
                createCategory(
                  "Veg",
                  "veg",
                  "checkbox",
                  [
                    "Mix Veg",
                    "Aalu Kauli",
                    "Veg Manchurian",
                    "Veg Kofta Curry",
                    "Butter Paneer Masala",
                    "Rajma Paneer",
                    "Mutter Mushroom Curry",
                    "Aalu Prawal",
                    "Aalu Bodi",
                    "Palak Paneer",
                  ],
                  3
                )
              );
              document.write(
                createCategory(
                  "Achar",
                  "achar",
                  "checkbox",
                  [
                    "Tomato Achar",
                    "Khatti Mithi Achar",
                    "Mula Kerau Achar",
                    "Green Salad",
                    "Gundruk Sadeko",
                    "Methi Achar",
                  ],
                  3
                )
              );
              document.write(
                createCategory("Chicken/Fish", "chickenFish", "radio", [
                  "Chicken Curry",
                  "Chicken Butter Masala",
                  "Fish Curry",
                ])
              );
              document.write(
                createCategory(
                  "Dessert",
                  "dessert",
                  "checkbox",
                  ["Curd", "Gulab Jamun", "Rasmalai", "Ice Cream"],
                  2
                )
              );
            </script>
          </div>
        </div>

        <div class="main-box">
          <h2>Extra Charged Items</h2>
          <div class="category-container">
            <!-- Extra items example -->
            <div class="category-box">
              <h3>Extra Chicken</h3>
              <label
                ><input
                  type="checkbox"
                  name="extraChicken"
                  value="Extra Chicken"
                />
                Extra Chicken</label
              >
            </div>
            <div class="category-box">
              <h3>Extra Rice</h3>
              <label
                ><input type="checkbox" name="extraRice" value="Extra Rice" />
                Extra Rice</label
              >
            </div>
          </div>
        </div>

        <!-- Input Section for Name, Email, and Submit -->
        <div class="input-section">
          <input
            type="text"
            id="name"
            placeholder="Enter your name"
            required
          /><br />
          <input
            type="email"
            id="email"
            placeholder="Enter your email"
            required
          /><br />
          <button type="button" id="verifyButton">Verify</button>
        </div>

        <!-- Section to Display Selected Options -->
        <div
          id="selectedOptions"
          class="selected-options"
          style="display: none"
        >
          <h3>Selected Options:</h3>
          <ul id="optionsList"></ul>
        </div>

        <button type="submit">Submit</button>
      </form>
    </div>

    <script>
      // Function to manage checkbox constraints
      const manageCheckboxConstraints = (className, limit) => {
        const checkboxes = document.querySelectorAll(`.${className}`);
        checkboxes.forEach((checkbox) => {
          checkbox.addEventListener("change", () => {
            const checkedCount = Array.from(checkboxes).filter(
              (cb) => cb.checked
            ).length;
            if (checkedCount >= limit) {
              checkboxes.forEach((cb) => {
                if (!cb.checked) cb.disabled = true; // Disable unchecked boxes
              });
            } else {
              checkboxes.forEach((cb) => (cb.disabled = false)); // Re-enable all boxes
            }
          });
        });
      };

      // Apply constraints to each question
      manageCheckboxConstraints("roti", 1);
      manageCheckboxConstraints("veg", 3);
      manageCheckboxConstraints("achar", 3);
      manageCheckboxConstraints("dessert", 2);

      // Verify button functionality
      document.getElementById("verifyButton").addEventListener("click", () => {
        const selectedOptions = [];
        // Iterate through each category to get selected items
        document
          .querySelectorAll(".category-container input:checked")
          .forEach((checkbox) => {
            selectedOptions.push(`${checkbox.name}: ${checkbox.value}`);
          });

        // Display selected options
        const optionsList = document.getElementById("optionsList");
        optionsList.innerHTML = ""; // Clear previous options
        selectedOptions.forEach((option) => {
          const li = document.createElement("li");
          li.textContent = option;
          optionsList.appendChild(li);
        });

        // Show the selected options section
        document.getElementById("selectedOptions").style.display = "block";
      });

      // Form submission
      document.getElementById("dynamicForm").addEventListener("submit", (e) => {
        e.preventDefault();
        alert("Form submitted successfully!");
        document.getElementById("dynamicForm").reset(); // Reset the form
        document
          .querySelectorAll('input[type="checkbox"]')
          .forEach((cb) => (cb.disabled = false)); // Re-enable checkboxes
        document.getElementById("selectedOptions").style.display = "none"; // Hide selected options
      });
    </script>
  </body>
</html>
